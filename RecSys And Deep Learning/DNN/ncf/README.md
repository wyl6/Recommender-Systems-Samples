# å‡†å¤‡å·¥ä½œ
> è¿™ç¯‡æ–‡ç« å‘è¡¨åœ¨ã€ŠWorld Wide Webã€‹ï¼ˆ2017ï¼‰ä¸Šï¼Œè®ºæ–‡é“¾æ¥ï¼šhttps://arxiv.org/pdf/1708.05031.pdf

> æ–‡ç« æå‡ºï¼Œç¥ç»ç½‘ç»œå·²ç»è¢«è¯æ˜å¯ä»¥è¿‘ä¼¼æ¨¡æ‹Ÿä»»æ„è¿ç»­å‡½æ•°[1]ï¼Œå¹¶ä¸”æ·±åº¦å­¦ä¹ åœ¨å¾ˆå¤šé¢†åŸŸçš„æˆåŠŸåº”ç”¨ä¹Ÿè¯æ˜äº†å…¶æœ‰æ•ˆæ€§ã€‚è€Œä¸€äº›è¿‘æœŸçš„ç ”ç©¶ä¹Ÿå°†æ·±åº¦å­¦ä¹ åº”ç”¨åˆ°äº†æ¨èä¸­ï¼Œç„¶è€Œå¾ˆå¤šå·¥ä½œéƒ½æ˜¯å°†æ·±åº¦å­¦ä¹ ä½œä¸ºè¾…åŠ©å·¥ä½œï¼Œæ¯”å¦‚æå–æ–‡æœ¬å’Œå›¾åƒçš„ç‰¹å¾ï¼Œè€Œå¯¹äºæ¨èçš„å…³é”®ç‰¹å¾å¤„ç†ï¼Œuserç‰¹å¾å’Œitemç‰¹å¾çš„äº¤äº’ï¼Œä»ä½¿ç”¨MFçš„æ€æƒ³ã€‚

> ä½œè€…åˆ©ç”¨æ·±åº¦å­¦ä¹ æ¥å¯¹userå’Œitemç‰¹å¾è¿›è¡Œå»ºæ¨¡ï¼Œä½¿æ¨¡å‹å…·æœ‰éçº¿æ€§è¡¨è¾¾èƒ½åŠ›ã€‚å…·ä½“æ¥è¯´ä½¿ç”¨å¤šå±‚æ„ŸçŸ¥æœºæ¥å­¦ä¹ user-itemäº¤äº’å‡½æ•°ã€‚



# 1. NCF åŸç†
![20190810114403.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810114403.png)

è¿™æ˜¯è®ºæ–‡ä¸­ç»™å‡ºçš„NCFçš„é€šç”¨æ¡†æ¶ï¼Œè¯•éªŒä¸­ä½¿ç”¨one-hotç¼–ç è¿›è¡Œæ˜ å°„ä¸ºuserå’Œitem latent vectorï¼Œç„¶åè¾“å…¥åˆ°MLPä¸­è¿›è¡Œè®­ç»ƒã€‚è¿™ä¸ªuserå’Œitemå¯ä»¥æ³›åŒ–åœ°ç†è§£ï¼Œæ¯”å¦‚ä½¿ç”¨åŸºäºå†…å®¹çš„æ–¹å¼ï¼Œå°±å¯ä»¥å»è§£å†³å†·å¯åŠ¨é—®é¢˜ã€‚

ä¸ªäººæ‹™è§ï¼Œè®ºæ–‡ä¸­çš„NCFé€šç”¨æ¨¡å‹å¹¶ä¸èƒ½å®ä¾‹åŒ–æˆè®ºæ–‡ä¸­è¯´çš„GMFï¼Œå› ä¸ºé€šç”¨æ¨¡å‹ä¸­è®²äº†æ˜¯åˆ©ç”¨å¤šå±‚æ„ŸçŸ¥æœºï¼Œè€ŒGMFæ˜¾ç„¶å’Œè¿™æ²¡ä»€ä¹ˆå…³ç³»ã€‚å¹¶ä¸”GMFé‚£éƒ¨åˆ†åªè¯æ˜äº†MFæ˜¯GMFçš„ç‰¹ä¾‹ï¼Œè€Œä¸èƒ½è¯æ˜GMFæ˜¯NCFçš„ç‰¹ä¾‹ã€‚
## 1.1 GMFæ¨¡å‹
![Screenshot_2019-08-05_20-47-063.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/Screenshot_2019-08-05_20-47-063.png)

ä»è®ºæ–‡ä¸­çš„è§£é‡Šçœ‹ï¼Œuserå’Œiteméƒ½é€šè¿‡one-hotç¼–ç å¾—åˆ°ç¨€ç–å‘é‡ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªembeddingå±‚æ˜ å°„ä¸ºuser vectorå’Œitem vectorã€‚è¿™æ ·å°±è·å¾—äº†userå’Œitemçš„éšå‘é‡ï¼Œå°±å¯ä»¥ä½¿ç”¨LFMçš„ç‚¹å‡»(Element-wise Produce)æ¥äº¤äº’userå’Œitemå‘é‡äº†ã€‚ä¸è¿‡åé¢å¤šäº†ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼š

![20190810112108.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810112108.png)

![20190810112207.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810112207.png)

æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒLFMæ¨¡å‹çš„userå’Œiteméšå‘é‡æ˜¯éšæœºåˆå§‹åŒ–ç„¶åè®­ç»ƒå‡ºæ¥ï¼Œè€Œè¿™é‡Œæ˜¯ä½¿ç”¨one-hotç¨€ç–å‘é‡åšembeddingæ˜ å°„ã€‚

## 1.2 MLP
![Screenshot_2019-08-05_20-47-062.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/Screenshot_2019-08-05_20-47-062.png)

è¿™é‡ŒåŒæ ·å…ˆé€šè¿‡æ˜ å°„è·å¾—userå’Œitem vectorï¼Œä½†è¦æ³¨æ„,ä¹‹å‰çš„MF vectorå’ŒMLP vectorè™½ç„¶åŒä¸ºæ˜ å°„çš„å‘é‡ï¼Œä½†ç»å¯¹ä¸ä¸€æ ·ï¼Œå› ä¸ºæ¨¡å‹å¯¹éšå‘é‡çš„ç»´åº¦ç­‰è¦æ±‚æ˜¯ä¸ä¸€æ ·çš„ã€‚

ç„¶åå°†userå’Œitem vectorè¾“å…¥åˆ°MLPä¸­è¿›è¡Œè®­ç»ƒï¼ŒMLPå¤§å®¶éƒ½çŸ¥é“ï¼Œé‡ç‚¹æ˜¯å¦‚ä½•å¤„ç†userå’Œitem vectorï¼Œä½œè€…æ˜¯ç›´æ¥å°†ä¸¤ä¸ªå‘é‡ä¸²è”èµ·æ¥ã€‚æ–‡ä¸­æŒ‡å‡ºè¿™æ˜¯å€Ÿé‰´äº†å¤šæ¨¡æ€ä¸­çš„åšæ³•ï¼Œæˆ‘ä¹‹å‰åšè¿‡ç‚¹å¤šæ¨¡æ€çš„ç ”ç©¶ï¼Œå®é™…ä¸Šï¼Œå¤šæ¨¡æ€ä¸­è¿™æ˜¯æœ€å¸¸è§çš„ä¸€ç§åšæ³•ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹å¼ï¼Œæ¯”å¦‚ç®€å•çš„ä¸²è”ååŠ ä¸ªæ­£åˆ™ï¼Œæˆ–è€…æ‰¾ä¸ªå»ºæ¨¡èƒ½åŠ›æ›´å¼ºçš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼ˆå¯èƒ½éœ€è¦è‡ªå·±è®¾è®¡ï¼‰ã€‚ä½œè€…åœ¨å½“æ—¶é‡‡ç”¨çš„è¿™ç§ç›´æ¥ä¸²è”çš„æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å¯ä»¥è¯´æ˜¯ä¸ªâ€œåˆ’æ—¶ä»£â€çš„åšæ³•ã€‚

è¿™æ ·ä¸²è”èµ·æ¥åï¼Œè¾“å…¥åˆ°MLPä¸­ï¼Œå¯ä»¥å­¦ä¹ å‡ºuserå’Œitemä¹‹é—´çš„éçº¿æ€§äº¤äº’å‡½æ•°ã€‚å…·ä½“MLPè¿‡ç¨‹æ˜¯è¿™ä¹ˆåšçš„ï¼š

![20190810113307.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810113307.png)

## 1.3 NeuMF
![20190805210049.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190805210049.png)

ä¸Šå›¾æ‰€ç¤ºçš„æ¡†æ¶è¢«ç§°ä¸ºâ€œNeural matrix factorization modelâ€ï¼Œç®€ç§°ä¸ºNeuMFã€‚ä½†å®é™…ä¸Šï¼Œæèµ·NCFå¯èƒ½æˆ‘ä»¬æƒ³åˆ°çš„å°±æ˜¯è¿™ä¸ªæ¨¡å‹ï¼Œæœ‰æ—¶å€™å’Œåˆ«äººäº¤æµï¼Œè¯´çš„NCFå°±æ˜¯æŒ‡è¿™ä¸ªæ¨¡å‹ã€‚

é¦–å…ˆæƒ³åˆ°çš„æ˜¯å°†ä¸¤ä¸ªæ¨¡å‹è¿›è¡Œç»“æœèåˆï¼Œå°±æ˜¯å°†ä¸¤ä¸ªæ¨¡å‹çš„â€œè¾“å‡ºâ€ç»“æœç›¸åŠ åå¥—ä¸ªæ¿€æ´»å‡½æ•°ï¼Œç„¶ååŠ ä¸€å±‚æ„ŸçŸ¥æœºè·å¾—æœ€ç»ˆç»“æœï¼š

![20190810162219.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810162219.png)

ä¸ªäººæ‹™è§ï¼Œå³ä½¿è¿›è¡Œç»“æœèåˆä¹Ÿåº”è¯¥å°†MFçš„éƒ¨åˆ†æ”¾åœ¨a(wx+b)çš„å¤–éƒ¨ï¼Œæœ€åä¸€èµ·åŠ ä¸€å±‚æ„ŸçŸ¥æœºã€‚æ¯•ç«Ÿwx+båŠ ä¸Šæ¿€æ´»å‡½æ•°æ‰æ˜¯MLPå€’æ•°ç¬¬äºŒå±‚çš„è¾“å‡ºã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦å†™åœ¨ä¸€ä¸ªæ‹¬å·é‡Œã€‚å¯èƒ½æ˜¯å®éªŒæ•ˆæœæ›´å¥½ï¼Ÿ

å…¶å®æ— æ‰€è°“ï¼Œè¿™ä¸ªå…¬å¼å·²ç»è¢«ä½œè€…é„™è§†åæŠ›å¼ƒã€‚å› ä¸ºè¿™ç§å…±äº«æœ€åä¸€å±‚åµŒå…¥å±‚çš„æ–¹å¼å¯èƒ½é™åˆ¶æ¨¡å‹çš„è¡¨è¾¾æ€§èƒ½ã€‚çœ‹å…¬å¼å°±çŸ¥é“ï¼ŒåµŒå…¥å±‚çš„è¾“å…¥è¦æ±‚pqå’Œwx+bå…·æœ‰ç›¸åŒçš„ç»´åº¦ï¼Œæ‰èƒ½è¿›è¡Œå‘é‡ç›¸åŠ ã€‚

ä¹‹å‰è®²è¿‡ï¼Œä¸èƒ½å¼ºè¡Œè¦æ±‚GMFå’ŒMLPåœ¨è¾“å…¥æ—¶çš„éšå‘é‡ç»´åº¦ä¸€è‡´ï¼Œæ¯•ç«Ÿæ˜¯ä¸¤ä¸ªä¸åŒçš„æ¨¡å‹ï¼Œæ‰€ä»¥åˆ†åˆ«åšembeddingã€‚ç°åœ¨å¯¹ä¸¤ä¸ªæ¨¡å‹çš„â€œè¾“å‡ºâ€ä¹Ÿä¸èƒ½åšè¿™ç§è¦æ±‚ï¼Œå› æ­¤ä½œè€…æƒ³äº†ä¸ªæ›´å¥½çš„åŠæ³•ï¼šå°†ä¸¤ä¸ªæ¨¡å‹çš„å€’æ•°ç¬¬äºŒå±‚ç‰¹å¾ä¸²è”ä¸ºä¸€ä¸ªç‰¹å¾ï¼Œç„¶ååŠ å±‚æ„ŸçŸ¥æœºï¼š

![20190810164448.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810164448.png)

å®é™…ä¸Šï¼Œhæ˜¯ä¸ªæƒé‡å‘é‡ï¼Œç›¸å½“äºå¯¹ä¸¤ä¸ªæ¨¡å‹å€’æ•°ç¬¬äºŒå±‚çš„ç»“æœè¿›è¡ŒåŠ æƒã€‚æˆ‘ä»¬çŸ¥é“ï¼Œé›†æˆæ¨¡å‹ä¸­ä¸€èˆ¬å¯¹æœ€åä¸€å±‚çš„è¾“å‡ºç»“æœè¿›è¡ŒåŠ æƒï¼Œç°åœ¨æ¢æˆå€’æ•°ç¬¬äºŒå±‚ï¼Œå°±å˜æˆäº†â€œç‰¹å¾â€èåˆï¼Œæœ€åçš„performanceè‚¯å®šä¹Ÿæ˜¯å¤§ä¸ç›¸åŒçš„ã€‚


# 2. å‡ ä¸ªé‡ç‚¹
## 2.1 æ˜¾æ€§åé¦ˆå’Œéšæ€§åé¦ˆ
NCFä¸“æ³¨äºä¸“æ³¨äº**éšæ€§åé¦ˆ**ï¼Œé€šè¿‡å‚è€ƒè§‚çœ‹è§†é¢‘ï¼Œè´­ä¹°äº§å“å’Œç‚¹å‡»é¡¹ç›®ç­‰é—´æ¥åæ˜ ç”¨æˆ·åå¥½çš„è¡Œä¸ºã€‚æ— è®ºä½ æ˜¯è¯„è¿‡åˆ†ï¼Œæ”¶è—è¿‡ï¼Œçœ‹è¿‡æœ‰å…³å†…å®¹ï¼Œéƒ½å¯ä»¥ä½œä¸ºéšæ€§åé¦ˆã€‚ä¸æ˜¾æ€§åé¦ˆï¼ˆè¯„åˆ†å’Œè¯„çº§ï¼‰ä¸åŒï¼Œéšæ€§åé¦ˆå¯ä»¥æ›´å®¹æ˜“æ”¶é›†ã€‚

å¯¹äºæœ‰è¯„åˆ†è¿™æ ·çš„æ˜¾æ€§åé¦ˆï¼Œæœ‰è¯„åˆ†å°±ç”¨ï¼Œæ²¡æœ‰è¯„åˆ†çš„æ•°æ®ä¹Ÿè¦å¤„ç†ï¼Œä¸€èˆ¬å°±æ˜¯è®°åˆ†å€¼ä¸º0ã€‚è€Œå¯¹äºéšæ€§åé¦ˆï¼Œä¸ºäº†å¤„ç†æ²¡æœ‰è§‚å¯Ÿåˆ°çš„æ•°æ®ï¼Œå¯ä»¥å°†æ‰€æœ‰æ— äº¤äº’çš„æ¡ç›®è§†ä¸ºè´Ÿåé¦ˆï¼Œä¹Ÿå¯ä»¥ä»ä¸­æŠ½æ ·ä½œä¸ºè´Ÿåé¦ˆå®ä¾‹ï¼ŒNCFä¸­ä¹Ÿè®°ä¸º0ã€‚

ä»¤ ğ‘€ å’Œ ğ‘ åˆ†åˆ«è¡¨ç¤ºç”¨æˆ·å’Œé¡¹ç›®çš„æ•°é‡ï¼Œé€šè¿‡ä»ç”¨æˆ·çš„éšæ€§åé¦ˆå­¦ä¹ user-itemäº¤äº’çŸ©é˜µï¼š

![20190810172020.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810172020.png)

è¿™é‡Œyä¸º 1 è¡¨ç¤ºç”¨æˆ· ğ‘¢ å’Œé¡¹ç›® ğ‘– å­˜åœ¨äº¤äº’è®°å½•;ç„¶è€Œè¿™å¹¶ä¸æ„å‘³ç€ ğ‘¢ çœŸçš„å–œæ¬¢ ğ‘–ã€‚åŒæ ·çš„ï¼Œå€¼ 0 ä¹Ÿä¸æ˜¯è¡¨æ˜ ğ‘¢ ä¸å–œæ¬¢ ğ‘–ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è¿™ä¸ªç”¨æˆ·æ ¹æœ¬ä¸çŸ¥é“æœ‰è¿™ä¸ªé¡¹ç›®ã€‚è¿™å¯¹éšæ€§åé¦ˆçš„å­¦ä¹ æå‡ºäº†æŒ‘æˆ˜ï¼Œå› ä¸ºå®ƒæä¾›äº†å…³äºç”¨æˆ·åå¥½çš„å™ªå£°ä¿¡å·ã€‚è™½ç„¶è§‚å¯Ÿåˆ°çš„æ¡ç›®è‡³å°‘åæ˜ äº†ç”¨æˆ·å¯¹é¡¹ç›®çš„å…´è¶£ï¼Œä½†æ˜¯æœªæŸ¥çœ‹çš„æ¡ç›®å¯èƒ½åªæ˜¯ä¸¢å¤±æ•°æ®ï¼Œå¹¶ä¸”è¿™å…¶ä¸­å­˜åœ¨è‡ªç„¶ç¨€ç–çš„è´Ÿåé¦ˆ[2]ã€‚æ˜¾ç„¶éšæ€§åé¦ˆä¸èƒ½åæ˜ ç”¨æˆ·çš„æ»¡æ„åº¦ï¼Œè¿˜æ˜¯æ˜¾æ€§çš„è¯„åˆ†æ›´å¥½ç”¨ã€‚

## 2.2 é€ç‚¹æŸå¤±å’Œæˆå¯¹æŸå¤±
æ–‡çŒ®ä¸­å¸¸ç”¨çš„æœ‰ä¸¤ç§å‡½æ•°ï¼šé€ç‚¹æŸå¤±(pointwise loss)å’Œæˆå¯¹æŸå¤±(pairwise loss)ã€‚é€ç‚¹æŸå¤±ä¸€èˆ¬é€šè¿‡æœ€å°åŒ–é¢„æµ‹å€¼yå’Œç›®æ ‡å€¼yä¹‹é—´çš„å¹³æ–¹è¯¯å·®ï¼Œä½¿ç”¨å›å½’çš„æ¡†æ¶æ¥ä¼°è®¡å‚æ•°ã€‚è€Œæˆå¯¹æŸå¤±çš„æ€æƒ³æ˜¯è§‚å¯Ÿåˆ°çš„æ¡ç›®åº”è¯¥æ¯”æœªè§‚å¯Ÿåˆ°çš„æ¡ç›®çš„è¯„åˆ†æ›´é«˜ï¼Œæ¨èçœ‹ä¸€çœ‹BPR(Bayesian personalized ranking)æ›´è¿›ä¸€æ­¥äº†è§£pairwise lossã€‚

> è€ƒè™‘åˆ°éšæ€§åé¦ˆçš„ä¸€ç±»æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† ğ‘¦ğ‘¢ğ‘– çš„å€¼ä½œä¸ºä¸€ä¸ªæ ‡ç­¾â€”â€”â€”â€”1è¡¨ç¤ºé¡¹ç›® ğ‘– å’Œç”¨æˆ· ğ‘¢ ç›¸å…³ï¼Œå¦åˆ™ä¸º0ã€‚è¿™æ ·ä¸€æ¥é¢„æµ‹åˆ†æ•° ğ‘¦Ë†ğ‘¢ğ‘– å°±ä»£è¡¨äº†é¡¹ç›® ğ‘– å’Œç”¨æˆ· ğ‘¢ ç›¸å…³çš„å¯èƒ½æ€§å¤§å°ã€‚ä¸ºäº†èµ‹äºˆNCFè¿™æ ·çš„æ¦‚ç‡è§£é‡Šï¼Œæˆ‘ä»¬éœ€è¦å°†ç½‘ç»œè¾“å‡ºé™åˆ¶åˆ°[0ï¼Œ1]çš„èŒƒå›´å†…ï¼Œé€šè¿‡ä½¿ç”¨æ¦‚ç‡å‡½æ•°ï¼ˆe.g. é€»è¾‘å‡½æ•°sigmoidæˆ–è€…probitå‡½æ•°ï¼‰ä½œä¸ºæ¿€æ´»å‡½æ•°ä½œç”¨åœ¨è¾“å‡ºå±‚ ğœ™ğ‘œğ‘¢ğ‘¡ ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å®ç°æ•°æ®å‹ç¼©ã€‚ç»è¿‡ä»¥ä¸Šè®¾ç½®åï¼Œæˆ‘ä»¬è¿™æ ·å®šä¹‰ä¼¼ç„¶å‡½æ•°[2]ï¼š

![20190810192614.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810192614.png)

ä¸Šé¢çš„è¿™æ®µè§£é‡Šå®åœ¨æ˜¯ç»å…¸ã€‚è¿™å¥è¯å¯¹ç†è§£é€»è¾‘å›å½’ä¸­çš„æŸå¤±å‡½æ•°ä¹Ÿæœ‰å¸®åŠ©ã€‚ã€Šä¼ ç»Ÿæ¨èç®—æ³•(äº”) FFMæ¨¡å‹(1) é€»è¾‘å›å½’æŸå¤±å‡½æ•°ã€‹ä¸­æˆ‘ä»¬è®²äº†è·å¾—ä¼¼ç„¶å‡½æ•°åå¦‚ä½•æ¨å¯¼æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œè¿™é‡Œä¸å†å¤šè¯´ï¼Œæå°åŒ–æŸå¤±å‡½æ•°çš„è¡¨è¾¾å¼æ˜¯ï¼š

![20190810192708.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810192708.png)

## 2.2 æ­£ä¾‹å’Œè´Ÿä¾‹çš„é€‰æ‹©
NCFä½¿ç”¨é€ç‚¹æŸå¤±å‡½æ•°ï¼Œä¸ºäº†å¤„ç†æ²¡æœ‰è§‚å¯Ÿåˆ°çš„æ•°æ®ï¼Œè¦ä¹ˆå°†æ‰€æœ‰æœªè§‚å¯Ÿåˆ°çš„æ¡ç›®è§†ä½œè´Ÿåé¦ˆï¼Œè¦ä¹ˆä»æ²¡æœ‰è§‚å¯Ÿåˆ°æ¡ç›®ä¸­æŠ½æ ·ä½œä¸ºè´Ÿåé¦ˆå®ä¾‹ã€‚è€Œæ­£ä¾‹å°±æ˜¯é‚£äº›æœ‰è®°å½•çš„äº¤äº’ã€‚
## 2.3 è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ’åˆ†
è®ºæ–‡ä½¿ç”¨ç•™ä¸€æœºåˆ¶ï¼Œå°±æ˜¯å°†ç”¨æˆ·æœ€è¿‘çš„é‚£æ¬¡äº¤äº’ä½œä¸ºæµ‹è¯•é›†ï¼Œå½“ç„¶äº¤äº’çš„ç‰©å“åŸºæœ¬ä¸ä¼šç›¸åŒï¼Œæ¯”å¦‚ç”¨æˆ·1æ˜¯25ï¼Œç”¨æˆ·2æ˜¯133ã€‚

æµ‹è¯•çš„æ—¶å€™ï¼Œå¹¶ä¸æ’åˆ—æ‰€æœ‰çš„itemï¼Œè€Œæ˜¯æŠ½æ ·100ä¸ªåštop kï¼ˆæ¯”å¦‚10ï¼‰æ¨èï¼Œåªè¦æµ‹è¯•çš„ç‰©å“åœ¨top 10é‡Œå°±ç®—æ¨èæˆåŠŸã€‚å½“ç„¶äº†ï¼Œä¸ºäº†é˜²æ­¢éšæœºæŠ½æ ·æ²¡æœ‰æŠ½ä¸­æµ‹è¯•çš„é‚£ä¸ªç‰©å“ï¼ˆè‚¯å®šæ¨èä¸åˆ°ï¼‰ï¼Œè®ºæ–‡ä»æ— äº¤äº’çš„ç‰©å“ä¸­æŠ½æ ·99ä¸ªï¼ŒåŠ ä¸Šæµ‹è¯•çš„ç‰©å“ï¼Œå‡‘æˆ100ä¸ªï¼Œåštop10æ¨èã€‚ç„¶åè®¡ç®—HRå’ŒNDCGæŒ‡æ ‡çš„å€¼åšè¯„ä¼°ã€‚
## 2.4 é¢„è®­ç»ƒæœºåˆ¶
é¦–å…ˆå•ç‹¬ä½¿ç”¨GMFå’ŒMLPè¿›è¡Œè®­ç»ƒï¼Œå¹¶è·å¾—æœ€åæ„ŸçŸ¥æœºå±‚çš„æƒé‡å’Œåç½®é¡¹ï¼Œç„¶åå°†è¿™äº›å‚æ•°ç”¨æ¥åˆå§‹åŒ–NeuMFä¸­GMFå’ŒMLPéƒ¨åˆ†ã€‚å½“ç„¶ï¼Œç»™äº†ä¸€ä¸ª$\alpha$æ§åˆ¶ä¸¤ä¸ªæƒé‡çš„è´¡çŒ®ã€‚

![20190810201350.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190810201350.png)

# 3. LFMå’ŒNCFçš„åŒºåˆ«
## 3.1 æ¦‚è¿°
LFMå¸¸ç”¨çš„å®ç°æ–¹å¼æ˜¯åŸºäºçŸ©é˜µåˆ†è§£æŠ€æœ¯ï¼Œé€šè¿‡æŸå¤±å‡½æ•°åŠ æ­£åˆ™çš„åå‘æ¢¯åº¦ä¸‹é™æ¥ä¼˜åŒ–æ¨¡å‹å‚æ•°ã€‚æ±‚è§£å‡ºæ¥çš„æ˜¯ç”¨æˆ·-éšç±»çŸ©é˜µå’Œç‰©å“-éšç±»çŸ©é˜µï¼Œå¯ä»¥ç†è§£ä¸ºç‰©å“å¯¹å„éšç±»çš„åçˆ±ç¨‹åº¦å’Œç‰©å“å¯¹å„éšç±»çš„å½’å±ç¨‹åº¦ã€‚æœ€åæ±‚å‡ºè¿™ä¸¤ä¸ªçŸ©é˜µï¼Œç„¶åå°±å¯ä»¥è®¡ç®—ç”¨æˆ·å¯¹ç‰©å“çš„è¯„åˆ†ã€‚

NCFæ˜¯é€šè¿‡ç¥ç»ç½‘ç»œä»æ•°æ®ä¸­å­¦ä¹ ç”¨æˆ·å’Œç‰©å“çš„äº¤äº’å…³ç³»ï¼Œæœ€åè¦è®­ç»ƒå‡ºä¸€ä¸ªæ¨¡å‹ã€‚

## 3.2 ç›¸åŒç‚¹
æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯æ¨¡æ‹Ÿç”¨æˆ·å’Œç‰©å“é—´çš„äº¤äº’å…³ç³»ã€‚
éƒ½å¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥æ±‚è§£å‚æ•°ã€‚

## 3.3 ä¸åŒç‚¹
### 3.3.1 å®ç°æ€æƒ³
LFMé€šè¿‡éšç‰¹å¾å°†ç”¨æˆ·ä¸ç‰©å“è”ç³»èµ·æ¥ï¼Œæ±‚è§£èƒ½æœ€å¤§ä¼¼ç„¶è”ç³»ç”¨æˆ·å’Œç‰©å“çš„éšç©ºé—´çš„ç‰¹å¾è¡¨è¾¾ï¼Œè€ŒNCFä½¿ç”¨NNæ¥å­¦ä¹ ç”¨æˆ·å’Œç‰©å“çš„äº¤äº’å‡½æ•°ï¼Œå…¶ä¸­åŒ…æ‹¬éšç‰¹å¾çš„æ±‚è§£è¿‡ç¨‹ï¼ˆone-hotåˆ°éšç‰¹å¾çš„æ˜ å°„å…³ç³»ï¼‰ï¼›
### 3.3.2 æ±‚è§£ç»“æœ
LFMæ±‚è§£çš„æ˜¯ç”¨æˆ·-éšç±»çŸ©é˜µå’Œç‰©å“-éšç±»çŸ©é˜µï¼Œè€ŒNCFæ±‚è§£å¾—åˆ°çš„æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼›
### 3.3.3 æ³›åŒ–èƒ½åŠ›
lfmåªèƒ½æ ¹æ®ä¸¤ä¸ªçŸ©é˜µï¼Œè®¡ç®—å·²å‡ºç°çš„ç”¨æˆ·å’Œå·²å‡ºç°ä½†æ²¡è¯„åˆ†çš„ç‰©å“çš„è¯„åˆ†ï¼Œåªèƒ½å¡«è¡¥åŸå…ˆç”¨æˆ·-ç‰©å“çŸ©é˜µçš„ç©ºç™½ï¼Œncfçš„æ¨¡å‹æ˜¯é€šç”¨çš„ï¼Œå¯ä»¥è®¡ç®—æ–°ç”¨æˆ·å’Œæ–°ç‰©å“ï¼ˆè¿™é‡Œèƒ½å®ç°çš„åŸå› æ˜¯ncfåœ¨è¾“å…¥å±‚æœ‰ä¸€ä¸ªæ˜ å°„å±‚ï¼Œå­¦å¾—å‚æ•°åå¯ä»¥è·å¾—ä¸€ä¸ªé€šç”¨æ˜ å°„å…³ç³»ï¼Œå¯ä»¥æ˜ å°„æ–°ç”¨æˆ·æˆ–æ–°ç‰©å“åˆ°éšç‰¹å¾ç©ºé—´ï¼Œè€Œlfmæ–°ç”¨æˆ·æ–°ç‰©å“æ²¡æ³•è·å¾—éšç‰¹å¾å‘é‡çš„è¡¨ç¤ºå½¢å¼ï¼‰ã€‚
### 3.3.4 å®ç°æ–¹æ³•
lfmå®ç°æ–¹å¼æœ€å¹¿çš„æ˜¯çŸ©é˜µåˆ†è§£ï¼ˆä¹Ÿæ˜¯å®ƒçš„æ€æƒ³æ¥æºï¼‰åŠ æ¢¯åº¦ä¸‹é™ã€‚å…¶ä¸­çš„ä¼˜åŒ–è¿‡ç¨‹ï¼ŒçŸ©é˜µåˆ†è§£çš„ä¼˜åŒ–å¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æœ€å°äºŒä¹˜æ³•ã€‚è€Œncfå®ç°è¿‡ç¨‹è®ºæ–‡ç»™å‡ºäº†ï¼Œç¥ç»ç½‘ç»œååŒè¿‡æ»¤ç”¨æ¢¯åº¦ä¸‹é™ã€‚
### 3.3.5 å­¦ä¹ èƒ½åŠ›
lfmåªè€ƒè™‘äº†å„éšç±»é—´çš„çº¿æ€§å…³ç³»ï¼Œéšç±»é—´ä¸€èˆ¬éƒ½æ˜¯éçº¿æ€§å…³ç³»çš„å°¤å…¶æ˜¯åœ¨éšç±»æ•°è¾ƒå°‘çš„æ—¶å€™ï¼›ncfç»“åˆä¸€ä¸ªæ¨å¹¿çš„çŸ©é˜µåˆ†è§£GMFï¼Œè€ƒè™‘å„éšç±»é—´çš„çº¿æ€§å…³ç³»çš„åŒæ—¶ï¼Œè¿˜ä½¿ç”¨MLPæ¥å­¦ä¹ ç”¨æˆ·å’Œç‰©å“é—´æ½œåœ¨ç‰¹å¾ä¹‹é—´çš„éçº¿æ€§å…³ç³»ã€‚éå¸¸çµæ´»ã€‚

# 4. å¤§å®¶ä¸€èµ·æ‰¾èŒ¬
## 4.1 user embedding & item embedding
åƒè®ºæ–‡ä¸­æ‰€è¯´çš„ï¼Œç”¨æˆ·åªæœ‰idä¿¡æ¯æ—¶ï¼Œé€šè¿‡idæ¥è¿›è¡Œæ˜ å°„æ˜¯å¦æœ‰å¿…è¦å‘¢ï¼Ÿè¿™ä¸ªidæ˜¯äººä¸ºèµ‹äºˆï¼Œidåªèƒ½å¸®æˆ‘ä»¬è®°å½•æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œæœ¬èº«ä¸å«æœ‰ä»»ä½•ä¿¡æ¯ï¼Œå®é™…ä¸Šï¼Œæ•°ç»„ä¸‹æ ‡å¯ä»¥ä¸€ä¸€å¯¹åº”ï¼Œå·²ç»å¯ä»¥å¸®åŠ©æˆ‘ä»¬è®°å½•æ˜¯å“ªä¸ªç”¨æˆ·ã€‚

å½“ç„¶ï¼Œè®ºæ–‡ä¸­è€ƒè™‘äº†è¿™ç‚¹ï¼Œå¹¶è¯´æ˜åº•éƒ¨è¾“å…¥å±‚çš„ä¸¤ä¸ªuserå’Œitemå‘é‡ï¼Œå¯ä»¥è¿›è¡Œå®šåˆ¶ï¼Œç”¨ä»¥æ”¯æŒå¹¿æ³›çš„userå’Œitemçš„å»ºæ¨¡ï¼Œæ¯”å¦‚ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼ŒåŸºäºå†…å®¹ç­‰ã€‚

ä½†æ˜¯ï¼Œåªæœ‰idçš„æƒ…å†µä¸‹ï¼Œå’ŒLFMçš„è®­ç»ƒç±»ä¼¼ï¼Œéšæ€§å‘é‡éšæœºåˆå§‹åŒ–å·²ç»è¶³å¤Ÿäº†ã€‚æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±åšä¸‹å®éªŒã€‚

## 4.2 æ³›åŒ–èƒ½åŠ›
æ­£å¦‚ä¹‹å‰æ‰€è¯´ï¼Œå¦‚æœuserå’Œitemåªæœ‰idçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ¨¡å‹æ³›åèƒ½åŠ›å¤ªå¼±ã€‚å› ä¸ºidæœ¬èº«åŒ…å«çš„ä¿¡æ¯å¤ªå°‘ï¼Œæ— è®ºæ–°æ¥çš„æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œidéƒ½æ˜¯ç¬¬kä¸ªï¼Œè·å¾—çš„user latent vectoréƒ½æ˜¯åŒä¸€ä¸ªï¼ŒitemåŒç†ã€‚

å› æ­¤ï¼Œ**å¦‚æœåªè€ƒè™‘user-itemè¿™æ ·çš„è¯„åˆ†çŸ©é˜µï¼ŒNCFçš„æ³›åèƒ½åŠ›æœ‰å¾…å•†æ¦·ï¼ˆå’ŒLFMæœ‰ä¸€æ‹¼ï¼Œè‡³å°‘è¿˜èƒ½embeddingä¸€ä¸ªéšå‘é‡å‡ºæ¥ï¼‰**ï¼Œä½†æ˜¯è€ƒè™‘åˆ°è®ºæ–‡æ‰€è¯´çš„ï¼Œä¸¤ä¸ªuserå’Œitemå‘é‡ï¼Œå¯ä»¥è¿›è¡Œå®šåˆ¶ï¼Œæ¯”å¦‚useræ˜¯ä¸€ä¸²æ–‡æœ¬æ¥è¡¨ç¤ºï¼Œé‚£å°±æœ‰æ³›åŒ–èƒ½åŠ›ã€‚

# 4. kerasæ‰‹æ’¸ncf

> è®ºæ–‡ä½œè€…ç»™äº†python2æºç ï¼š
> https://github.com/hexiangnan/neural_collaborative_filtering
> 
> æˆ‘çš„å®éªŒç¯å¢ƒï¼š
> keras: 2.6.4
> python: 3.6.4
> numpy: 1.14.0
> 
> å¯èƒ½ç‰ˆæœ¬ä¸å¯¹ï¼Œè·‘çš„æ—¶å€™æœ‰å¾ˆå¤šé”™,æˆ‘æ”¹äº†äº›é”™å¹¶æ”¹æˆpython3ç‰ˆæœ¬ï¼š
https://github.com/wyl6/Recommender-Systems-Samples/tree/master/RecSys%20And%20Deep%20Learning/DNN/ncf





# å¼•ç”¨
[1] Hornik, K., Stinchcombe, M., & White, H. (1989). Multilayer feedforward networks are universal approximators. Neural networks, 2(5), 359-366.
[2] https://www.cnblogs.com/HolyShine/p/6728999.html
