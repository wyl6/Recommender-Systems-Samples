
@[toc]
## å†™åœ¨å‰é¢
> å¯¹å¥‡å¼‚å€¼åˆ†è§£æ•°å­¦åŸç†æœ‰ç–‘æƒ‘çš„ï¼Œè¯·é˜…è¯»ï¼šã€Š[ä¼ ç»Ÿæ¨èç®—æ³•(ä¸€)åˆ©ç”¨SVDè¿›è¡Œæ¨èï¼ˆ3ï¼‰6ä¸ªå±‚é¢é€å½»äº†è§£å¥‡å¼‚å€¼åˆ†è§£ã€‹](https://blog.csdn.net/xxiaobaib/article/details/92012829)
> å‚è€ƒä»£ç ï¼šhttps://github.com/felipessalvatore/Recommender
> é‡æ„ä»£ç ï¼šhttps://github.com/wyl6/Traditional-Classical-Conventional-Recommender-Systems/tree/master/MF/FunkSVD
> å‚è€ƒä»£ç ä¸­å°†FunkSVDå’ŒNSVDå†™åœ¨ä¸€èµ·ï¼Œæˆ‘è§‰å¾—ä½œè€…å†™å¾—è¿˜ä¸é”™ï¼Œçœ‹èµ·æ¥æœ‰scikit-learnä»£ç çš„é£æ ¼ã€‚å°±å‚è€ƒäº†ä»–çš„ä»£ç ä¸­SVDé‚£ä¸€éƒ¨åˆ†ç»ƒç»ƒæ‰‹ã€‚

## 1.ä¼ ç»ŸSVDåˆ†è§£çš„ç¼ºé™·
åœ¨ã€Šä¼ ç»Ÿæ¨èç®—æ³•(ä¸€)ï¼ˆ4ï¼‰å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬è®²äº†åˆ©ç”¨SVDå®ç°å¯¹ç‰©å“çš„éšç‰¹å¾é™ç»´ï¼Œè¿™æ˜¯SVDåœ¨æ¨èä¸­çš„ä¸€ç§åº”ç”¨ã€‚å®é™…ä¸Šè¿˜æœ‰ä¸€ç§åº”ç”¨ï¼Œå°±æ˜¯åˆ©ç”¨SVDå¯¹è¯„åˆ†çŸ©é˜µè¿›è¡Œåˆ†è§£ï¼Œç„¶ååˆ©ç”¨é™ç»´åçš„U,S,Vå¯¹çŸ©é˜µè¿›è¡Œè¿˜åŸï¼ŒåŸå…ˆçŸ©é˜µä¸­ç©ºç¼ºçš„éƒ¨åˆ†å°±å¯ä»¥å¾—åˆ°å¡«å……å€¼ã€‚ç¬¬ä¸€ç§åº”ç”¨ä¸­SVDå°±æ˜¯ä½œä¸ºé™ç»´æŠ€æœ¯ï¼Œä¼˜åŒ–ç›¸ä¼¼åº¦è®¡ç®—çš„è¿‡ç¨‹ï¼›ç¬¬äºŒç§åˆ©ç”¨è¿™ç§çŸ©é˜µåˆ†è§£æŠ€æœ¯åˆ†è§£åå†å¡«å……ï¼Œå°†å¡«å……çš„ç»“æœä½œä¸ºé¢„æµ‹å€¼ã€‚

ç¬¬ä¸€ç§ç¼ºç‚¹å·²ç»åˆ†æè¿‡äº†ï¼Œæœ¬æ–‡é‡ç‚¹çœ‹ä¸€ä¸‹ç¬¬äºŒç§åº”ç”¨çš„ç¼ºç‚¹ï¼Œè¿™ç§åº”ç”¨å°±æ˜¯FunkSVDæ”¹è¿›å‰çš„SVDæ¨èã€‚




### 1.1 ç¨€ç–çŸ©é˜µçš„ç¼ºå¤±å€¼é—®é¢˜

[2]ä¸­æŒ‡å‡ºâ€œå¥‡å¼‚å€¼åˆ†è§£ä½œä¸ºçŸ©é˜µåˆ†è§£ä¸­æœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œé€šå¸¸éƒ½æ˜¯ä½œç”¨äºå®Œæ•´çš„çŸ©é˜µï¼ˆå³çŸ©é˜µä¸­ä¸å­˜åœ¨å…ƒç´ ç¼ºå¤±çš„ç°è±¡ï¼‰ï¼Œå³è¦æ±‚çŸ©é˜µå¿…é¡»æ˜¯ç¨ å¯†çŸ©é˜µâ€ã€‚[3]ä¸­æŒ‡å‡ºâ€œè¿™ç§æ–¹æ³•å­˜åœ¨ä¸€ä¸ªè‡´å‘½çš„ç¼ºé™·â€”â€”å¥‡å¼‚å€¼åˆ†è§£è¦æ±‚çŸ©é˜µæ˜¯â€œç¨ å¯†â€çš„â€ã€‚

æ³¨ï¼šè¿™é‡Œçš„â€œç¨ å¯†â€æŒ‡çš„æ˜¯çŸ©é˜µä¸èƒ½æœ‰ç¼ºå¤±å…ƒç´ (æœ‰ç¼ºå¤±å…ƒç´ åˆ†è§£ä¸ªé”¤å­)ã€‚å’Œä¸‹æ–‡ä¸­çš„ç¨ å¯†æœ‰æ‰€åŒºåˆ«ã€‚

ç”±äºå®é™…ä¸­å¤§å¤šæ•°è¯„åˆ†çŸ©é˜µéƒ½ä¼šæœ‰ç¼ºå¤±å€¼ï¼Œæ‰€ä»¥ç”¨è¿™ç§SVDåˆ†è§£å¡«å……çš„è¯ï¼Œç¬¬ä¸€æ­¥éƒ½ä¼šæƒ³åŠæ³•å¯¹ç¼ºå¤±å€¼åšä¸€ä¸ªâ€œç²—ç³™çš„â€å¡«è¡¥ã€‚è¿™ä¸ªå¡«è¡¥ä¼šé€ æˆé—®é¢˜ã€‚

### 1.2 ç¨€ç–çŸ©é˜µçš„å¡«è¡¥é—®é¢˜
> å†å²ä¸Šå¯¹ç¼ºå¤±å€¼çš„ç ”ç©¶æœ‰å¾ˆå¤šï¼Œå¯¹äºä¸€ä¸ªæ²¡æœ‰è¢«æ‰“åˆ†çš„ç‰©å“æ¥è¯´ï¼Œåˆ°åº•æ˜¯åº”è¯¥ç»™å®ƒè¡¥ä¸€ä¸ª 0 å€¼ï¼Œè¿˜æ˜¯åº”è¯¥ç»™å®ƒè¡¥ä¸€ä¸ªå¹³å‡å€¼å‘¢ï¼Ÿç”±äºåœ¨å®é™…è¿‡ç¨‹ä¸­ï¼Œå…ƒç´ ç¼ºå¤±å€¼æ˜¯éå¸¸å¤šçš„ï¼Œè¿™å°±å¯¼è‡´äº†æ—©æœŸçš„SVDä¸è®ºé€šè¿‡ä»¥ä¸Šå“ªç§æ–¹æ³•è¿›è¡Œè¡¥å…¨åœ¨å®é™…çš„åº”ç”¨ä¹‹ä¸­éƒ½æ˜¯å¾ˆéš¾è¢«æ¥å—çš„ã€‚

â€œç²—ç³™çš„â€å¡«å……ä¼šé€ æˆä¸¤ä¸ªæ˜æ˜¾çš„é—®é¢˜[5]ï¼šç¬¬ä¸€ï¼Œå¢åŠ äº†æ•°æ®é‡ï¼Œå¢åŠ äº†ç®—æ³•å¤æ‚åº¦ã€‚ç¬¬äºŒï¼Œç®€å•ç²—æš´çš„æ•°æ®å¡«å……å¾ˆå®¹æ˜“é€ æˆæ•°æ®å¤±çœŸã€‚æˆ‘ä»¬å‘ç°å¾ˆå¤šæ—¶å€™éƒ½æ˜¯ç›´æ¥è¡¥0ï¼Œå¾—åˆ°ä¸€ä¸ªéå¸¸ç¨€ç–çš„æ‰“åˆ†çŸ©é˜µã€‚è¿™ç§è¡¥é›¶çš„æƒ…å†µè¿˜ä¼šé€ æˆç©ºé—´çš„æµªè´¹ã€‚

### 1.3 SVDè®¡ç®—å¤æ‚åº¦é—®é¢˜

[1]ä¸­æŒ‡å‡ºï¼š
> SVD åˆ†è§£çš„å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œå‡è®¾å¯¹ä¸€ä¸ª ğ‘šÃ—ğ‘› çš„çŸ©é˜µè¿›è¡Œåˆ†è§£ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º ğ‘‚(ğ‘›2âˆ—ğ‘š+ğ‘›âˆ—ğ‘š2)ï¼Œå…¶å®å°±æ˜¯ ğ‘‚(ğ‘›3)ã€‚å¯¹äº mã€n æ¯”è¾ƒå°çš„æƒ…å†µï¼Œè¿˜æ˜¯å‹‰å¼ºå¯ä»¥æ¥å—çš„ï¼Œä½†æ˜¯åœ¨æ¨èåœºæ™¯çš„æµ·é‡æ•°æ®ä¸‹ï¼Œm å’Œ n çš„å€¼é€šå¸¸ä¼šæ¯”è¾ƒå¤§ï¼Œå¯èƒ½æ˜¯ç™¾ä¸‡çº§åˆ«ä¸Šçš„æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœå†è¿›è¡Œ SVD åˆ†è§£éœ€è¦çš„è®¡ç®—ä»£ä»·å°±æ˜¯å¾ˆå¤§çš„ã€‚

[4]ä¸­æŒ‡å‡ºï¼š
> SVDè®¡ç®—ä»£ä»·å¾ˆå¤§ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯3æ¬¡æ–¹çš„ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯2æ¬¡æ–¹çš„ã€‚è™½ç„¶æœ‰ä¸€äº›å·ç§°å¹¶è¡Œçš„SVDç®—æ³•ï¼Œä½†æ®æˆ‘æ‰€çŸ¥ï¼Œå¦‚æœä¸èƒ½å…±äº«å†…å­˜ï¼ŒSVDå¾ˆéš¾å¹¶è¡ŒåŒ–ã€‚

### 1.4 SVDåˆ†è§£å¯¹å†…å­˜çš„æ¶ˆè€—é—®é¢˜

å¯¹äº1ä¸‡ä¸ªç”¨æˆ·ï¼Œ1000ä¸‡ä¸ªç‰©å“çš„è¯„åˆ†çŸ©é˜µï¼Œæˆ‘ä»¬ç®€å•ä¼°è®¡ä¸‹å®ƒéœ€è¦çš„å†…å­˜ã€‚å‡è®¾æ¯ä¸ªè¯„åˆ†ç”¨4ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œé‚£ä¹ˆSVDåˆ†è§£æ—¶ï¼Œå°†è¿™ä¸ªå®Œæ•´çš„çŸ©é˜µåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¤§æ¦‚éœ€è¦372Gå†…å­˜ã€‚å†…å­˜æ˜¯å¦èƒ½å®¹çº³æ˜¯ä¸ªå¤§é—®é¢˜ã€‚

### 1.5 SVDçš„ç‰¹å¾è¡¨è¾¾é—®é¢˜
åœ¨åœ¨ã€Šä¼ ç»Ÿæ¨èç®—æ³•(ä¸€)ï¼ˆ4ï¼‰å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬åˆ†æè¿‡è¿™ä¸ªï¼ŒSVDåˆ†è§£æ–¹å¼æ¯”è¾ƒå•ä¸€ï¼Œåˆ†è§£å¾—åˆ°çš„ç‰¹å¾è¡¨ç¤ºæ˜¯å¦ä¸€å®šæ˜¯ç”¨æˆ·/ç‰©å“çš„ä¸€ç§æ¯”è¾ƒå¥½çš„è¡¨ç¤ºå‘¢ï¼Ÿä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œè·å–çš„ç‰¹å¾çš„æ–¹å¼ä¸å¤Ÿçµæ´»ï¼Œé‚£ä¹ˆè¿™æ ·æ— è®ºæ˜¯åœ¨ç¬¬ä¸€ç§é™ç»´çš„åº”ç”¨ï¼Œè¿˜æ˜¯åœ¨ç¬¬äºŒç§å¡«å……çš„åº”ç”¨ä¸­ï¼Œéƒ½ä¸èƒ½ä¿è¯è·å–å¥½çš„ç»“æœã€‚

æ‰€ä»¥ï¼Œç”¨SVDè¿›è¡Œè¯„åˆ†çŸ©é˜µå¡«å……æ—¶ï¼Œå¹¶ä¸ä¼šé‡‡ç”¨æ­£ç»Ÿçš„SVDåˆ†è§£ï¼Œè€Œæ˜¯é‡‡ç”¨ä¸€ç§çµæ´»çš„ç‰ˆæœ¬ï¼Œè¯·è§1.6ã€‚

### 1.6ç¨€ç–çŸ©é˜µçš„SVDåˆ†è§£é—®é¢˜

ç”±äºå¥‡å¼‚å€¼åˆ†è§£çš„è®¡ç®—è¿‡ç¨‹è¾ƒæ…¢ï¼Œæ‰€ä»¥åœ¨å®é™…ä½¿ç”¨SVDåˆ†è§£è¿›è¡Œå¡«å……é¢„æµ‹æ—¶ï¼Œä½¿ç”¨çš„æ˜¯â€œä¼ªSVDâ€åˆ†è§£(å›¾ç‰‡æ¥è‡ªå­Ÿä¸€å‡¡å¤§ä½¬çš„æˆªå›¾)ï¼š
![1753035041.jpg](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/1753035041.jpg)

è¿™é‡Œçš„Uå’ŒVæ˜¯ç”¨æˆ·å’Œç‰©å“çš„éšå‘é‡ï¼ŒÎ£æ˜¯å¯¹è§’é˜µï¼Œé€šè¿‡æœ€å°åŒ–å¹³æ–¹è¯¯å·®çš„è§£ææ–¹æ³•æ¥æ±‚è§£ã€‚æœ€å°åŒ–å¹³æ–¹è¯¯å·®é€šå¸¸ç”¨æœ€å°äºŒä¹˜æ³•(ALS)æˆ–è€…æ¢¯åº¦ä¸‹é™ã€‚ç”±äºæ­£ç»Ÿçš„SVDåˆ†è§£å‡ºæ­£äº¤çŸ©é˜µä¼šæ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥åœ¨å®é™…æ“ä½œä¸­åªå–SVDç²¾é«“ï¼Œè®­ç»ƒå‡ºç”¨æˆ·å’Œç‰©å“çš„éšå‘é‡Uå’ŒVå³å¯ï¼Œä¸è¦æ±‚Uå’ŒVæ­£äº¤ã€‚

æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒU,Î£,Vä¸­æœ‰è®¸å¤šå‚æ•°éœ€è¦ç¡®å®šï¼Œå¦‚æœçŸ©é˜µè¿‡äºç¨€ç–ï¼Œæ˜¾ç„¶æ¨¡å‹çš„æ•ˆæœä¸ä¼šç†æƒ³ã€‚å¦‚æœæƒ³è¦ä¿è¯æ¨¡å‹æ•ˆæœï¼Œå°±å¿…é¡»ä¿è¯è®­ç»ƒæ•°æ®å……åˆ†ï¼Œè¦æ±‚çŸ©é˜µä¸èƒ½ç¨€ç–ï¼Œæ¯•ç«Ÿæ¨¡å‹å‚æ•°å¤ªå¤šäº†ã€‚å­Ÿä¸€å‡¡å¤§ä½¬çš„è¯è¯´:
> â€œå¦‚æœæ•°æ®å¾ˆç¨€ç–ï¼Œæ¨¡å‹èƒ½åˆ©ç”¨çš„ä¿¡æ¯æ˜¯æœ‰é™çš„ï¼Œç®—æ³•å¡«å……çŸ©é˜µçš„èƒ½åŠ›ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥ç¨ å¯†ã€‚â€

é‚£è¿™å°±å°´å°¬äº†ï¼Œå®é™…ä¸­çš„è¯„åˆ†çŸ©é˜µç¨ å¯†äº†è¿˜éœ€è¦å¡«å……å—ï¼Œè¿˜éœ€è¦é¢„æµ‹å—ï¼Ÿè¿™ç§æ”¹è¿›åçš„â€œä¼ªSVDâ€ä¾ç„¶ä¸å¤Ÿç»™åŠ›ã€‚

## 2.éšè¯­ä¹‰æ¨¡å‹LFM

### 2.1 å¤§åé¼é¼çš„LFM
ä¹‹å‰æˆ‘ä»¬åˆ†æè¿‡ï¼ŒSVDåˆ†è§£åï¼š

![](https://github.com/wyl6/wyl6.github.io/blob/master/imgs_for_blogs/recommender_traditional/MF/SVD/1.bmp?raw=true)

å…¶å®å¯ä»¥ç®€åŒ–ä¸ºï¼š

![](https://github.com/wyl6/wyl6.github.io/blob/master/imgs_for_blogs/recommender_traditional/MF/SVD/3.bmp?raw=true)

åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä»â€œä¼ªSVDâ€ä¸­ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°ï¼š
![å›¾ç‰‡æ¥è‡ª[6]](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190623224258.png)

å€˜è‹¥å°†å¥‡å¼‚å€¼èåˆåˆ°u<sub>i</sub>å’Œv<sub>i</sub>å’Œä¸­å»ï¼Œå°±å¯ä»¥å°†çŸ©é˜µåˆ†è§£è½¬åŒ–ä¸ºä¸€ä¸ªå‚æ•°ä¼°è®¡é—®é¢˜[6]ï¼š
![20190623225630.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190623225630.png)

è¿™æ ·å¾—åˆ°çš„ç”¨æˆ·å’Œç‰©å“éšç‰¹å¾çŸ©é˜µè™½ç„¶ä¸ä¸€å®šå…·å¤‡ç»å…¸å¥‡å¼‚å€¼åˆ†è§£çš„æ­£äº¤çŸ©é˜µæ€§è´¨ï¼Œä½†æ˜¯ç”¨æ¥ä½œä¸ºç”¨æˆ·å’Œç‰©å“çš„ç‰¹å¾è¡¨è¾¾(éšå› å­)ä¹Ÿè¶³å¤Ÿäº†ã€‚
> å¹¶ä¸”è¿™éšå«ç€æœºå™¨å­¦ä¹ çš„å¸¸ç”¨æ–¹æ³•è®ºï¼šåªè¦éšå› å­åœ¨ä¼°è®¡å·²çŸ¥è¯„åˆ†æ—¶è¶³å¤Ÿå‡†ï¼Œé‚£ä¹ˆè¾…ä»¥ä¸€äº›æ­£åˆ™åŒ–ä¿è¯æ³›åŒ–èƒ½åŠ›ä¹‹åå®ƒåœ¨æœªçŸ¥è¯„åˆ†ä¸Šçš„é¢„æµ‹ä¹Ÿèƒ½æ»¡è¶³ç²¾åº¦è¦æ±‚[6]ã€‚
> 
æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç›¸æ¯”åˆšæ‰çš„â€œä¼ªSVDâ€ï¼Œè¿™ä¸ªæ¨¡å‹ä¹Ÿå¯ä»¥è·å¾—ç”¨æˆ·å’Œç‰©å“çš„ç‰¹å¾è¡¨è¾¾ï¼Œå¹¶ä¸”å°†åŸæ¥çš„å¥‡å¼‚å€¼èåˆè¿›äº†ç‰¹å¾ä¸­ï¼Œç‰¹å¾åŒ…å«äº†æ›´å¤šçš„ä¿¡æ¯ï¼›åŒæ—¶å‚æ•°æ•°é‡å¤§å¤§ä¸‹é™ï¼Œç›¸åŒçš„è®­ç»ƒæ•°æ®ï¼Œè¿™ä¸ªæ¨¡å‹æ˜¾ç„¶å¯ä»¥æ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚**è¿™ä¸ªæ¨¡å‹å°±æ˜¯å¤§åé¼é¼çš„LFMæ¨¡å‹ã€‚**


**2006å¹´ï¼ŒFunkSVDSimon Funk åœ¨åšå®¢ä¸Šå…¬å¸ƒäº†ä¸€ä¸ªç®—æ³•(Funk-SVD)ï¼Œè¿™ä¸ªç®—æ³•åæ¥è¢«Netflix Prize çš„å† å†› Koren ç§°ä¸º Latent Factor Model(LFM)ã€‚[7]**

LFMé€šè¿‡ä»¥ä¸‹å…¬å¼æ¥è®¡ç®—ç”¨æˆ·uå¯¹ç‰©å“içš„è¯„åˆ†ï¼š

![Screenshot from 2019-06-22 11-10-50.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/Screenshot%20from%202019-06-22%2011-10-50.png)

æˆ‘ä»¬å¯ä»¥æŠŠp<sub>uk</sub>çœ‹æˆæ˜¯ç”¨æˆ·uå¯¹ç¬¬kä¸ªéšç±»çš„å…´è¶£ï¼ŒæŠŠq<sub>ik</sub>çœ‹æˆæ˜¯ç‰©å“iå’Œç¬¬kä¸ªéšç±»çš„ç›¸å…³æ€§ã€‚

### 2.2 æŸå¤±å‡½æ•°åŠè®­ç»ƒ
æˆ‘ä»¬å€ŸåŠ©[7]ä¸­å†…å®¹ç®€è¦çœ‹ä¸€ä¸‹ã€‚SVDæŸå¤±å‡½æ•°ä¸ºï¼š

![20190624094234.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190624094234.png)

å¯ä»¥é€šè¿‡äº¤æ›¿æœ€å°äºŒä¹˜æ³•æˆ–è€…æ¢¯åº¦ä¸‹é™æ³•æ¥è®­ç»ƒæ¨¡å‹ã€‚æ¯”å¦‚ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°åå¯¼ä¸ºï¼š
![20190624094746.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190624094746.png)

å‚æ•°æ²¿æœ€é€Ÿä¸‹é™æ–¹å‘å‰è¿›æ—¶ï¼Œé€’æ¨å…¬å¼ä¸ºï¼š
![20190624094846.png](https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/20190624094846.png)

## 3.FunkSVDåŠå…¶å˜ç§
FunkSVDçš„å˜ç§å¾ˆå¤šï¼Œç®€å•æ•´ç†ä¸€ä¸‹ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚Matrix Factorization(MF)å¯ä»¥çœ‹æˆæ˜¯LFMå¸¦èµ·æ¥çš„ä¸€ç§è§£å†³æ¨èé—®é¢˜çš„æ€è·¯ï¼Œæœ‰çš„äººç›´æ¥å«LFMä¸ºMFæ¨¡å‹ã€‚ä½†æ˜¯ç°åœ¨çŸ©é˜µåˆ†è§£æŠ€æœ¯å¾ˆå¤šï¼Œä¸å»ºè®®è¿™æ ·å«ï¼Œä¸ç„¶åˆ«äººå¯èƒ½ä¸çŸ¥é“ä½ è¯´çš„æ˜¯çŸ©é˜µåˆ†è§£è¿™ä¸€ç±»æŠ€æœ¯è¿˜æ˜¯LFMè¿™ä¸ªæ¨¡å‹ã€‚

| ç®—æ³• | åˆ«å | å†…å®¹ |
| :-----| :----: | :----: |
| SVD | traditional SVD | å¥‡å¼‚å€¼åˆ†è§£ |
| FunkSVD | LFM, basic MF, MF | LFM |
| bias SVD | bias MF | LFM+åç½®é¡¹ |
| regularized SVD | regularized MF | LFM+æ­£åˆ™é¡¹ |
| PMF | * | LFM+æ­£åˆ™é¡¹çš„æ¦‚ç‡ç‰ˆæœ¬ |
| SVD++ | * | LFM+æ­£åˆ™é¡¹+éšæ€§åé¦ˆ |
| NMF | * | å¯¹éšå‘é‡éè´Ÿé™åˆ¶ï¼Œå¯ç”¨åœ¨bias SVDç­‰ä¸åŒæ¨¡å‹ä¸Š |
| NSVD | * | å­¦ä¹ ä¸¤ä¸ªç‰©å“éšå› å­ï¼Œè€Œéå­¦ä¹ ç”¨æˆ·ã€ç‰©å“éšå› å­ |
| WRMF | * | å¼•å…¥æ—¶é—´ä¿¡æ¯ï¼Œå¯ç”¨åœ¨bias SVDç­‰ä¸åŒæ¨¡å‹ä¸Š |





## 3.Tensorflowå®ç°FunkSVD
FunkSVDå¯ä»¥è¯´æ˜¯ä¸€ä¸ªä¸Šå¤æˆ˜ç¥äº†ï¼Œæ¨¡å‹æ¯”è¾ƒç®€å•ï¼Œç½‘ä¸Šæœ‰ä¸å°‘ç”¨Pythonå†™çš„ï¼Œä»£ç éƒ½ä¸é•¿ã€‚æˆ‘ä»¬çœ‹çœ‹tensorflowå¦‚ä½•å®ç°ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹å„å˜é‡çš„å®šä¹‰ï¼š
```Python
import numpy as np
import tensorflow as tf
import time
import os
from util import rmse, status_printer

def inference_svd(batch_user, batch_item, num_user, num_item, dim=5):
    
    with tf.name_scope('Declaring_variables'):
        
        ## obtain global bias, user bias, item bias
        w_bias_user = tf.get_variable('num_bias_user', shape=[num_user])
        w_bias_item = tf.get_variable('num_bias_item', shape=[num_item])
        bias_global = tf.get_variable('bias_global', shape=[])
        bias_user = tf.nn.embedding_lookup(w_bias_user, 
                                           batch_user, 
                                           name='batch_bias_user')
        bias_item = tf.nn.embedding_lookup(w_bias_item, 
                                           batch_item, 
                                           name='batch_bias_imte')
        
        ## obtain user embedding, item embedding
        initializer = tf.truncated_normal_initializer(stddev=0.02)
        w_user = tf.get_variable('num_embed_user', 
                                 shape=[num_user, dim], 
                                 initializer=initializer)
        w_item = tf.get_variable('num_embed_item', 
                                 shape=[num_item, dim], 
                                 initializer=initializer)
        embed_user = tf.nn.embedding_lookup(w_user, 
                                            batch_user, 
                                            name='batch_embed_user')
        embed_item = tf.nn.embedding_lookup(w_item, 
                                            batch_item, 
                                            name='batch_embed_item')
```
å®é™…ä¸Šè¿™ä»½ä»£ç å¯ä»¥åšæ›´å¤šæ‰©å±•ï¼Œä¸ä»…ä»…åŠ å…¥åç½®é¡¹å’Œæ­£åˆ™é¡¹ã€‚ç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹é¢„æµ‹å€¼ï¼š
```Python
        ## obtain r_ij = p_i*q_j
        infer = tf.reduce_sum(tf.multiply(embed_user, embed_item), 1) 
        
        ## obtain bias
        infer = tf.add(infer, bias_global)
        infer = tf.add(infer, bias_user)
        infer = tf.add(infer, bias_item, name='svd_inference')
```
ç„¶åçœ‹çœ‹æ­£åˆ™é¡¹å®šä¹‰ï¼š
```Python
## obtain regularizer
        l2_user = tf.sqrt(tf.nn.l2_loss(embed_user))
        l2_item = tf.sqrt(tf.nn.l2_loss(embed_item))
        l2_sum = tf.add(l2_user, l2_item)
        bias_user_sq = tf.square(bias_user)
        bias_item_sq = tf.square(bias_item)
        bias_sum = tf.add(bias_user_sq, bias_item_sq)
        regularizer = tf.add(l2_sum, bias_sum, name='svd_regularizer')
        
        regularizer = tf.add(tf.nn.l2_loss(embed_user), 
                             tf.nn.l2_loss(embed_item), 
                             name="svd_regularizer")
```
é‚£ä¹ˆæŸå¤±å‡½æ•°å°±å¾ˆæ¸…æ™°äº†ï¼š
```Python
def loss_function(infer, regularizer, batch_rate, reg):
    '''
    calculate loss = loss_l2+loss_regularizer
    '''
    loss_l2 = tf.square(tf.subtract(infer, batch_rate))
    reg = tf.constant(reg, dtype=tf.float32, name='reg')
    loss_regularizer = tf.multiply(regularizer, reg)
    loss = tf.add(loss_l2, loss_regularizer)
    return loss
```
è®­ç»ƒè¿‡ç¨‹ä½¿ç”¨:
```Python
self.train_op = optimizer.minimize(self.loss, global_step=global_step)
```
å°±ä¸å¤šè¯´äº†ã€‚è¿™ä»½ä»£ç æ˜¯æˆ‘ä»ä¸€ä»½ä»£ç é‡Œé‡æ„å‡ºæ¥çš„ï¼Œæ¨èå¤§å®¶é˜…è¯»ä¸€ä¸‹ã€‚ä¸æ¨èè·Ÿç€æ‰‹å†™ä¸€éï¼Œæœ‰ç‚¹é•¿ï¼Œæƒ³æ‰‹å†™çš„å»ºè®®æ‰¾ä¸ªpythonç‰ˆæœ¬çš„ï¼Œç®€å•å¥½ç”¨ã€‚

ç­‰å†™SVD++é‚£ä¸€éƒ¨åˆ†çš„æ—¶å€™ï¼Œå°½é‡æ‰¾ä¸ªçŸ­çš„ï¼Œæ¯•ç«Ÿè¿™äº›ä»£ç åªæ˜¯å¸®åŠ©ç†è§£ï¼ŒçœŸç”¨çš„æ—¶å€™ç›´æ¥è°ƒæˆç†Ÿçš„åŒ…æ›´å¥½äº›ã€‚


## å‚è€ƒ
- [1] https://lumingdong.cn/recommendation-algorithm-based-on-matrix-decomposition.html#ref-footnote-4-1
- [2] https://zhuanlan.zhihu.com/p/25512080
- [3] https://zhuanlan.zhihu.com/p/34497989
- [4] https://www.zhihu.com/question/22572629
- [5] http://baogege.info/2014/10/19/matrix-factorization-in-recommender-systems/
- [6] https://zhuanlan.zhihu.com/p/38630064
- [7] é¡¹äº®. æ¨èç³»ç»Ÿå®è·µ[J]. åŒ— äº¬: äºº æ°‘ é‚® ç”µ å‡º ç‰ˆ ç¤¾, 2012: 39-44.

## å…¬ä¼—å·
æ›´å¤šç²¾å½©å†…å®¹è¯·ç§»æ­¥å…¬ä¼—å·:æ¨èç®—æ³•å·¥ç¨‹å¸ˆ

<img src="https://raw.githubusercontent.com/wyl6/wyl6.github.io/master/imgs_for_blogs/deep_learning/dnn/tensorflow_mnist/wechat.jpg" width = "200" height = "200" />

æ„Ÿè§‰å…¬ä¼—å·å†…å®¹ä¸é”™ç‚¹ä¸ªå…³æ³¨å‘—